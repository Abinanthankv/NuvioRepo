/**
 * tamilmv - Built from src/tamilmv/
 * Generated: 2026-01-14T08:15:41.074Z
 */
var k=Object.defineProperty,L=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var V=(e,r,t)=>r in e?k(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,h=(e,r)=>{for(var t in r||(r={}))A.call(r,t)&&V(e,t,r[t]);if(R)for(var t of R(r))U.call(r,t)&&V(e,t,r[t]);return e},p=(e,r)=>L(e,v(r));var g=(e,r,t)=>new Promise((c,n)=>{var l=o=>{try{a(t.next(o))}catch(s){n(s)}},i=o=>{try{a(t.throw(o))}catch(s){n(s)}},a=o=>o.done?c(o.value):Promise.resolve(o.value).then(l,i);a((t=t.apply(e,r)).next())});var E=require("cheerio-without-node-native"),B="1b3113663c9004682ed61086cf967c44",C="https://api.themoviedb.org/3",w="https://www.1tamilmv.lc",M={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${w}/`};function T(c){return g(this,arguments,function*(e,r={},t=1e4){let n=new AbortController,l=setTimeout(()=>n.abort(),t);try{let i=yield fetch(e,p(h({},r),{signal:n.signal}));return clearTimeout(l),i}catch(i){throw clearTimeout(l),i.name==="AbortError"?new Error(`Request timeout after ${t}ms`):i}})}function D(e,r,t,c){for(;t--;)if(c[t]){let n=t.toString(r);e=e.replace(new RegExp("\\b"+n+"\\b","g"),c[t])}return e}function x(e){return e?e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function _(e,r){let t=x(e),c=x(r);if(t===c)return 1;if(t.includes(c)||c.includes(t))return .9;let n=new Set(t.split(/\s+/).filter(o=>o.length>2)),l=new Set(c.split(/\s+/).filter(o=>o.length>2));if(n.size===0||l.size===0)return 0;let i=new Set([...n].filter(o=>l.has(o))),a=new Set([...n,...l]);return i.size/a.size}function b(e,r){if(!r||r.length===0)return null;let t=e.title.toLowerCase().replace(/[^a-z0-9]/g,""),c=e.year?parseInt(e.year):null,n=null,l=0;for(let i of r){let a=i.title.toLowerCase().replace(/[^a-z0-9]/g,""),o=_(e.title,i.title),s=a.includes(t)||t.includes(a),u=!c||i.title.includes(c.toString())||i.title.includes((c+1).toString())||i.title.includes((c-1).toString());s&&u&&(o+=.5),o>l&&(l=o,n=i)}return n&&l>.4?(console.log(`[TamilMV] Best title match: "${n.title}" (score: ${l.toFixed(2)})`),n):null}function W(e){return g(this,null,function*(){try{console.log(`[TamilMV] Embed URL: ${e}`);let t=new URL(e).hostname.toLowerCase();return console.log(`[TamilMV] Attempting to extract from: ${t}`),t.includes("hglink")||t.includes("hubglink")?yield d(e,"hglink"):t.includes("luluvid")?yield d(e,"luluvid"):t.includes("wishonly")?yield d(e,"wishonly"):t.includes("dhcplay")?yield d(e,"dhcplay"):t.includes("vidnest")?yield d(e,"vidnest"):t.includes("strmup")?yield z(e):(console.log(`[TamilMV] No extractor for ${t}, skipping`),null)}catch(r){return console.error(`[TamilMV] Extraction error: ${r.message}`),null}})}function z(e){return g(this,null,function*(){try{let r=new URL(e),t=r.origin,c=r.pathname.split("/").filter(a=>a).pop();if(!c)return null;console.log(`[TamilMV] Strmup filecode: ${c}`);let n=`${t}/ajax/stream?filecode=${c}`,i=yield(yield T(n,{headers:p(h({},M),{"X-Requested-With":"XMLHttpRequest",Referer:e})},5e3)).json();return i&&i.streaming_url?(console.log(`[TamilMV] Found direct URL from strmup: ${i.streaming_url}`),i.streaming_url):null}catch(r){return console.error(`[TamilMV] Strmup extraction failed: ${r.message}`),null}})}function d(e,r){return g(this,null,function*(){try{let t=new URL(e).origin,n=yield(yield T(e,{headers:p(h({},M),{Referer:w})},5e3)).text();if(n.includes("<title>Loading...</title>")||n.includes("Page is loading")){console.log(`[TamilMV] Detected landing page on ${r}, trying mirrors...`);let o=["yuguaab.com","cavanhabg.com"];for(let s of o){if(r.includes(s))continue;let u=e.replace(r,s);try{let m=yield(yield T(u,{headers:p(h({},M),{Referer:w})},3e3)).text();if(m.includes("jwplayer")||m.includes("sources")||m.includes("eval(function(p,a,c,k,e,d)")){n=m;break}}catch(f){}}}let l=n.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(l){let s=l[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(s){let u=D(s[1],parseInt(s[2]),parseInt(s[3]),s[4].split("|"));n+=`
`+u}}let i=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi,/https?:\/\/[^\s"']+\.mp4[^\s"']*/gi,/(?:source|file|src)\s*[:=]\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/gi],a=[];for(let o of i){let s=n.match(o);if(s)for(let u of s){let f=u,m=u.match(/["']:[ ]*["']([^"']+)["']/);if(m)f=m[1];else{let $=u.match(/["']([^"']+)["']/);$&&(f=$[1])}let y=f.match(/https?:\/\/[^\s"']+/);y&&(f=y[0]),f=f.replace(/[\\"'\)\]]+$/,""),!(!f||f.length<5||f.includes("google.com")||f.includes("youtube.com"))&&(f.startsWith("/")&&!f.startsWith("//")&&(f=t+f),a.push(f))}}if(a.length>0){a.sort((s,u)=>{let f=s.toLowerCase().includes(".m3u8"),m=u.toLowerCase().includes(".m3u8");return f!==m?m?1:-1:s.length-u.length});let o=a[0];return console.log(`[TamilMV] Found direct URL from ${r}: ${o}`),o}return console.log(`[TamilMV] No direct URL found in ${r}, skipping`),null}catch(t){return console.error(`[TamilMV] Error extracting from ${r}: ${t.message}`),null}})}function H(e,r){return g(this,null,function*(){let c=`${C}/${r==="movie"?"movie":"tv"}/${e}?api_key=${B}`;try{let n=yield T(c,{},8e3);if(!n.ok)throw new Error(`TMDB error: ${n.status}`);let l=yield n.json();if(!l.title&&!l.name)throw new Error("TMDB returned no title");let i={title:l.title||l.name,year:(l.release_date||l.first_air_date||"").split("-")[0]};return console.log(`[TamilMV] TMDB Info: "${i.title}" (${i.year||"N/A"})`),i}catch(n){throw console.error("[TamilMV] Error fetching TMDB metadata:",n.message),n}})}function q(e){let r=E.load(e),t=[];return r('a:contains("[WATCH]")').each((c,n)=>{let l=r(n).attr("href");if(!l)return;let i=[],a=n.previousSibling;for(!a&&n.parentNode&&(a=n.parentNode.previousSibling);a;){let s=r(a),u=a.tagName?a.tagName.toLowerCase():null;if(u==="br"||u==="p"||u==="hr"||u==="div"||s.text().includes("[WATCH]"))break;i.unshift(a),a=a.previousSibling}let o=r(i).text().trim();o=o.replace(/^[- \t\n\r|\[\], \u00A0]+/,"").replace(/[- \t\n\r|\[\], \u00A0]+$/,"").trim(),o&&t.push({title:o,watchUrl:l})}),t}function S(e,r="movie",t=null,c=null){return g(this,null,function*(){console.log(`[TamilMV] Processing ${r} ${e}`);try{let n;if(/^\d+$/.test(e))try{n=yield H(e,r)}catch(f){console.log(`[TamilMV] TMDB fetch failed for ${e}, using as search query`),n={title:e,year:null}}else console.log(`[TamilMV] Using "${e}" as search query directly`),n={title:e,year:null};console.log(`[TamilMV] Looking for ${n.title} (${n.year}) on homepage`);let a=yield(yield fetch(w,{headers:M})).text(),o=q(a),s=b(n,o);if(!s)return console.warn("[TamilMV] No matching title with [WATCH] link found on homepage"),[];console.log(`[TamilMV] Found watch link for: ${s.title}`),console.log("[TamilMV] Extracting direct stream from watch URL...");let u=yield W(s.watchUrl);return u?[{name:"TamilMV",title:s.title.split(" - ")[0].trim(),url:u,quality:s.title.includes("720p")?"720p":s.title.includes("1080p")?"1080p":"Unknown",headers:{Referer:w,"User-Agent":M["User-Agent"]},provider:"TamilMV"}]:(console.log("[TamilMV] Could not extract direct stream, skipping"),[])}catch(n){return console.error("[TamilMV] getStreams failed:",n.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:S}:global.getStreams={getStreams:S};
