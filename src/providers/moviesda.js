/**
 * moviesda - Built from src/moviesda/
 * Generated: 2026-01-18T09:51:23.733Z
 */
var H=Object.defineProperty,Y=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var B=(t,o,s)=>o in t?H(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,R=(t,o)=>{for(var s in o||(o={}))j.call(o,s)&&B(t,s,o[s]);if(A)for(var s of A(o))Q.call(o,s)&&B(t,s,o[s]);return t},E=(t,o)=>Y(t,G(o));var y=(t,o,s)=>new Promise((l,e)=>{var n=r=>{try{a(s.next(r))}catch(u){e(u)}},c=r=>{try{a(s.throw(r))}catch(u){e(u)}},a=r=>r.done?l(r.value):Promise.resolve(r.value).then(n,c);a((s=s.apply(t,o)).next())});var x=require("cheerio-without-node-native"),C="1b3113663c9004682ed61086cf967c44",z="https://api.themoviedb.org/3",m="https://moviesda15.com",$={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${m}/`};function v(l){return y(this,arguments,function*(t,o={},s=1e4){let e=new AbortController,n=setTimeout(()=>e.abort(),s);try{let c=yield fetch(t,E(R({},o),{signal:e.signal}));return clearTimeout(n),c}catch(c){throw clearTimeout(n),c.name==="AbortError"?new Error(`Request timeout after ${s}ms`):c}})}function F(t){return t?t.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function V(t,o){let s=F(t),l=F(o);if(s===l)return 1;if(s.includes(l)||l.includes(s))return .9;let e=new Set(s.split(/\s+/).filter(r=>r.length>2)),n=new Set(l.split(/\s+/).filter(r=>r.length>2));if(e.size===0||n.size===0)return 0;let c=new Set([...e].filter(r=>n.has(r))),a=new Set([...e,...n]);return c.size/a.size}function J(t,o,s,l){for(;s--;)if(l[s]){let e=s.toString(o);t=t.replace(new RegExp("\\b"+e+"\\b","g"),l[s])}return t}function X(t,o){if(!o||o.length===0)return null;let s=t.year?parseInt(t.year):null,l=null,e=0;for(let n of o){let c=V(t.title,n.title);s&&(n.title.includes(s.toString())?c+=.3:(n.title.includes((s+1).toString())||n.title.includes((s-1).toString()))&&(c+=.1)),c>e&&(e=c,l=n)}return l&&e>.4?(console.log(`[Moviesda] Best match: "${l.title}" (score: ${e.toFixed(2)})`),l):null}function P(t,o){let s=o.quality||"Unknown",l=t.title||"Unknown",e=t.year||"",n="",c=o.text?o.text.match(/(\d+(?:\.\d+)?\s*(?:GB|MB))/i):null;c&&(n=c[1]);let a="",r=((o.text||"")+" "+(o.url||"")).toLowerCase();r.includes("bluray")||r.includes("brrip")?a="BluRay":r.includes("web-dl")?a="WEB-DL":r.includes("webrip")?a="WEBRip":r.includes("hdrip")?a="HDRip":r.includes("dvdrip")?a="DVDRip":r.includes("bdrip")?a="BDRip":r.includes("hdtv")&&(a="HDTV");let u=a?`\u{1F4F9}: ${a}
`:"",d=n?`\u{1F4BE}: ${n} | \u{1F69C}: moviesda
`:"",i=e&&e!=="N/A"?` ${e}`:"",f={TAMIL:/tamil/i,HINDI:/hindi/i,TELUGU:/telugu/i,MALAYALAM:/malayalam/i,KANNADA:/kannada/i,ENGLISH:/english|eng/i,"MULTI AUDIO":/multi/i},h="TAMIL";for(let[g,p]of Object.entries(f))if(p.test(r)){h=g;break}return`Moviesda (Instant) (${s})
${u}\u{1F4FC}: ${l}${i} ${s}
${d}\u{1F310}: ${h}`}function Z(t,o){return y(this,null,function*(){let l=`${z}/${o==="movie"?"movie":"tv"}/${t}?api_key=${C}`;try{let n=yield(yield v(l,{},8e3)).json(),c={title:n.title||n.name,year:(n.release_date||n.first_air_date||"").split("-")[0]};return console.log(`[Moviesda] TMDB Info: "${c.title}" (${c.year||"N/A"})`),c}catch(e){throw console.error("[Moviesda] Error fetching TMDB metadata:",e.message),e}})}function ee(t,o){return y(this,null,function*(){let l=`${z}/search/${o==="movie"?"movie":"tv"}?api_key=${C}&query=${encodeURIComponent(t)}`;try{console.log(`[Moviesda] Searching TMDB for: "${t}"`);let n=yield(yield v(l,{},8e3)).json();if(n.results&&n.results.length>0){let c=n.results[0],a={title:c.title||c.name,year:(c.release_date||c.first_air_date||"").split("-")[0]};return console.log(`[Moviesda] TMDB Search Result: "${a.title}" (${a.year||"N/A"})`),a}return console.log(`[Moviesda] No TMDB results found for "${t}"`),null}catch(e){return console.error("[Moviesda] Error searching TMDB:",e.message),null}})}function te(t,o=null){return y(this,null,function*(){console.log(`[Moviesda] Searching for: "${t}" (year: ${o||"any"})`);try{let s=[],l=[];if(o)l.push(`${m}/tamil-${o}-movies/`);else{let e=new Date().getFullYear();for(let n=e;n>=e-2;n--)l.push(`${m}/tamil-${n}-movies/`)}console.log(`[Moviesda] Checking ${l.length} category pages`);for(let e of l)try{let c=yield(yield v(e,{headers:$},8e3)).text(),a=x.load(c);a('a[href*="-tamil-movie"], a[href*="-movie/"]').each((r,u)=>{let d=a(u).attr("href"),i=a(u).text().trim();if(!d||d.includes("/tamil-movies/")||d==="#"||i.length<3)return;let f=i.match(/^(.+?)\s*(?:\((\d{4})\))?$/);if(f){let h=f[1].trim(),g=f[2]||null,p=d.startsWith("http")?d:`${m}${d}`;s.push({title:i,cleanTitle:h,year:g,href:p})}})}catch(n){console.error(`[Moviesda] Error browsing ${e}: ${n.message}`)}return console.log(`[Moviesda] Found ${s.length} total movies in categories`),s}catch(s){return console.error("[Moviesda] Search error:",s.message),[]}})}function oe(t,o){return y(this,null,function*(){try{let s=new URL(t).origin,e=yield(yield v(t,{headers:E(R({},$),{Referer:m})},5e3)).text(),n=e.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(n){console.log(`[Moviesda] Detected Packer obfuscation on ${o}, unpacking...`);let u=n[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(u){let d=J(u[1],parseInt(u[2]),parseInt(u[3]),u[4].split("|"));e+=`
`+d}}let c=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi,/https?:\/\/[^\s"']+\.mp4[^\s"']*/gi,/(?:source|file|src)\s*[:=]\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/gi],a=[];for(let r of c){let u=e.match(r);if(u&&u.length>0)for(let d of u){let i=d,f=d.match(/["']:[ ]*["']([^"']+)["']/);if(f)i=f[1];else{let g=d.match(/["']([^"']+)["']/);g&&(i=g[1])}let h=i.match(/https?:\/\/[^\s"']+/);h&&(i=h[0]),i=i.replace(/[\\"'\)\]]+$/,""),!(!i||i.length<5||i.includes("google.com")||i.includes("youtube.com"))&&(i.startsWith("/")&&!i.startsWith("//")&&(i=s+i),a.push(i))}}if(a.length>0){a.sort((u,d)=>{let i=u.toLowerCase().includes(".m3u8"),f=d.toLowerCase().includes(".m3u8");return i!==f?f?1:-1:u.length-d.length});let r=a[0];return console.log(`[Moviesda] Found direct URL from ${o}: ${r}`),r}return console.log(`[Moviesda] No direct URL found in ${o}, skipping`),null}catch(s){return console.error(`[Moviesda] Error extracting from ${o}: ${s.message}`),null}})}function re(t){return y(this,null,function*(){try{console.log(`[Moviesda] Extracting from embed: ${t}`);let s=new URL(t).hostname.toLowerCase();return s.includes("onestream.watch")?yield T(t):yield oe(t,s)}catch(o){return console.error(`[Moviesda] Extraction error: ${o.message}`),null}})}function T(t){return y(this,null,function*(){console.log(`[Moviesda] Extracting from onestream.watch: ${t}`);try{let s=yield(yield v(t,{headers:E(R({},$),{Referer:m})},8e3)).text(),l=x.load(s),e=[];if(l("video source").each((a,r)=>{let u=l(r).attr("src"),d=l(r).attr("type");u&&e.push({src:u,type:d})}),e.length>0){let a=e[0].src;return console.log(`[Moviesda] Found direct URL from onestream: ${a}`),a}let n=s.match(/https?:\/\/[^\s"']+\.m3u8[^\s"']*/i);if(n)return console.log(`[Moviesda] Found m3u8 URL: ${n[0]}`),n[0];let c=s.match(/https?:\/\/[^\s"']+\.mp4[^\s"']*/i);return c?(console.log(`[Moviesda] Found mp4 URL: ${c[0]}`),c[0]):(console.log("[Moviesda] No direct URL found in onestream page"),null)}catch(o){return console.error(`[Moviesda] Onestream extraction error: ${o.message}`),null}})}function _(t){return y(this,null,function*(){console.log(`[Moviesda] Parsing movie page: ${t}`);try{let s=yield(yield v(t,{headers:$},8e3)).text(),l=x.load(s),e=[],n=l('a[href*="-original-movie"]');if(n.length>0){let r=n.attr("href"),u=r.startsWith("http")?r:`${m}${r}`;return console.log(`[Moviesda] Found original page link: ${u}`),yield se(u)}let c=[];if(l("a").each((r,u)=>{let d=l(u).attr("href"),i=l(u).text().trim();if(d&&i.match(/\b(360p|480p|720p|1080p|4K)\s*HD\b/i)){let f=i.match(/\b(360p|480p|720p|1080p|4K)\b/i),h=f?f[0]:"Unknown",g=d.startsWith("http")?d:`${m}${d}`;c.push({url:g,quality:h})}}),c.length>0){console.log(`[Moviesda] Found ${c.length} quality pages`);for(let r of c){let u=yield I(r.url,r.quality);u.forEach(d=>{d.text||(d.text=r.text||"")}),e.push(...u)}return e}let a=[];return l("a").each((r,u)=>{let d=l(u).attr("href"),i=l(u).text().trim();if(d&&d.includes("/download/")){let f=d.startsWith("http")?d:`${m}${d}`;a.push({url:f,text:i})}}),a.length>0&&(console.log(`[Moviesda] Found ${a.length} download links on quality page`),a.forEach(r=>{e.push({url:r.url,quality:"Unknown",type:"download"})})),console.log(`[Moviesda] Found ${e.length} streams on page`),e}catch(o){return console.error("[Moviesda] Movie page parse error:",o.message),[]}})}function se(t){return y(this,null,function*(){console.log(`[Moviesda] Parsing original page: ${t}`);try{let s=yield(yield v(t,{headers:$},8e3)).text(),l=x.load(s),e=[];l("a").each((c,a)=>{let r=l(a).attr("href"),u=l(a).text().trim();if(r&&u.match(/\b(360p|480p|720p|1080p|4K)\s*HD\b/i)){let d=u.match(/\b(360p|480p|720p|1080p|4K)\b/i),i=d?d[0]:"Unknown",f=r.startsWith("http")?r:`${m}${r}`;e.push({url:f,quality:i,type:"quality_page"})}}),console.log(`[Moviesda] Found ${e.length} quality pages on original page`);let n=[];for(let c of e){let a=yield I(c.url,c.quality);n.push(...a)}return n}catch(o){return console.error("[Moviesda] Original page parse error:",o.message),[]}})}function I(t,o){return y(this,null,function*(){console.log(`[Moviesda] Parsing quality page (${o}): ${t}`);try{let l=yield(yield v(t,{headers:$},8e3)).text(),e=x.load(l),n=[];return e("a").each((c,a)=>{let r=e(a).attr("href"),u=e(a).text().trim();if(r&&r.includes("/download/")){let d=r.startsWith("http")?r:`${m}${r}`;n.push({url:d,quality:o,type:"download",text:u})}}),console.log(`[Moviesda] Found ${n.length} download links for ${o}`),n}catch(s){return console.error(`[Moviesda] Quality page parse error (${o}): ${s.message}`),[]}})}function N(t){return y(this,null,function*(){console.log(`[Moviesda] Extracting final URL from: ${t}`);try{let s=yield(yield v(t,{headers:$},8e3)).text(),l=x.load(s),e=[];if(l("a").each((n,c)=>{let a=l(c).attr("href"),r=l(c).text().trim().toLowerCase();if(a&&!a.includes("moviesda15.com")&&!a.includes("/tamil-movies/")&&!a.startsWith("#")&&(r.includes("download")||r.includes("server"))){let u=a.startsWith("http")?a:`https:${a}`;e.push(u)}}),e.length>0){let n=e[0];if(console.log(`[Moviesda] Found download URL: ${n}`),n.includes("download.moviespage.xyz/download/file/")){let c=n.match(/\/file\/(\d+)/);if(c){let r=`https://play.onestream.watch/stream/page/${c[1]}`;return console.log(`[Moviesda] Converted to onestream URL: ${r}`),{url:r,needsExtraction:!0}}}return{url:n,needsExtraction:!1}}return console.log("[Moviesda] No final download URL found on page"),null}catch(o){return console.error(`[Moviesda] Error extracting final URL: ${o.message}`),null}})}function W(t,o="movie",s=null,l=null){return y(this,null,function*(){console.log(`[Moviesda] Processing ${o} ${t}`);try{let e;if(/^\d+$/.test(t))try{e=yield Z(t,o)}catch(i){console.log(`[Moviesda] TMDB fetch failed, using "${t}" as search query`),e={title:t,year:null}}else{console.log(`[Moviesda] Using "${t}" as search query`);try{let i=yield ee(t,o);i&&i.year?e=i:e={title:t,year:null}}catch(i){console.log(`[Moviesda] TMDB search failed: ${i.message}`),e={title:t,year:null}}}console.log(`[Moviesda] Looking for: "${e.title}" (${e.year||"N/A"})`);let c=yield te(e.title,e.year),a=X(e,c);if(!a){console.warn("[Moviesda] No matching title found in category pages");let i=new Date().getFullYear(),f=e.year?[e.year,i,i-1]:[i,i-1,i+1,i-2,i-3,i-4];for(let h of f){let g=e.title.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"-"),p=`${m}/${g}-${h}-tamil-movie/`;console.log(`[Moviesda] Trying direct URL: ${p}`);try{let w=yield v(p,{headers:$},5e3);if(w.ok){let D=yield w.text();if(D.includes("entry-title")||D.includes("movie")){console.log(`[Moviesda] \u2713 Direct URL found: ${p}`);let b=yield _(p);if(b.length>0){let O=b.slice(0,5),S=[];for(let U of O){let k=U.url;if(U.type==="download")try{let M=yield Promise.race([N(U.url),new Promise((L,q)=>setTimeout(()=>q(new Error("Extraction timeout")),5e3))]);if(!M)continue;if(M.needsExtraction)try{let L=yield Promise.race([T(M.url),new Promise((q,K)=>setTimeout(()=>K(new Error("Onestream extraction timeout")),5e3))]);if(!L)continue;k=L}catch(L){console.error(`[Moviesda] Onestream extraction failed: ${L.message}`);continue}else k=M.url}catch(M){console.error(`[Moviesda] Download URL extraction failed: ${M.message}`);continue}S.push({name:"Moviesda",title:P(e,U),url:k,quality:U.quality||"Unknown",headers:{Referer:m,"User-Agent":$["User-Agent"]},provider:"Moviesda"})}return console.log(`[Moviesda] Successfully extracted ${S.length} streams`),S}}}}catch(w){console.log(`[Moviesda] Direct URL failed for ${h}: ${w.message}`)}}return console.warn("[Moviesda] No results found via category search or direct URL"),[]}console.log(`[Moviesda] Processing match: ${a.title}`);let r=yield _(a.href);if(r.length===0)return console.warn("[Moviesda] No streams found on movie page"),[];let u=r.slice(0,5);r.length>5&&console.log(`[Moviesda] Limiting to first 5 streams out of ${r.length}`);let d=[];for(let i of u){let f=i.url;if(i.type==="download")try{let h=yield Promise.race([N(i.url),new Promise((g,p)=>setTimeout(()=>p(new Error("Extraction timeout")),5e3))]);if(!h){console.log("[Moviesda] Failed to extract final URL from download page, skipping");continue}if(h.needsExtraction){console.log("[Moviesda] URL needs extraction from onestream");try{let g=yield Promise.race([T(h.url),new Promise((p,w)=>setTimeout(()=>w(new Error("Onestream extraction timeout")),5e3))]);if(!g){console.log("[Moviesda] Failed to extract from onestream, skipping");continue}f=g}catch(g){console.error(`[Moviesda] Onestream extraction failed: ${g.message}`);continue}}else f=h.url}catch(h){console.error(`[Moviesda] Download URL extraction failed: ${h.message}`);continue}else if(i.type==="embed")try{let h=yield Promise.race([re(i.url),new Promise((g,p)=>setTimeout(()=>p(new Error("Extraction timeout")),5e3))]);if(!h){console.log("[Moviesda] Failed to extract from embed, skipping");continue}f=h}catch(h){console.error(`[Moviesda] Embed extraction failed: ${h.message}`);continue}d.push({name:"Moviesda",title:P(e,i),url:f,quality:i.quality,headers:{Referer:m,"User-Agent":$["User-Agent"]},provider:"Moviesda"})}return console.log(`[Moviesda] Successfully extracted ${d.length} streams`),d}catch(e){return console.error("[Moviesda] getStreams failed:",e.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:W}:global.getStreams={getStreams:W};
