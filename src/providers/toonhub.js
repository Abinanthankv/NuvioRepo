/**
 * toonhub - Built from src/toonhub/
 * Generated: 2026-01-12T12:10:32.902Z
 */
var K=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var L=(n,e,o)=>e in n?K(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,x=(n,e)=>{for(var o in e||(e={}))O.call(e,o)&&L(n,o,e[o]);if(B)for(var o of B(e))Q.call(e,o)&&L(n,o,e[o]);return n},y=(n,e)=>X(n,Z(e));var S=(n,e,o)=>new Promise((s,t)=>{var r=l=>{try{h(o.next(l))}catch(d){t(d)}},i=l=>{try{h(o.throw(l))}catch(d){t(d)}},h=l=>l.done?s(l.value):Promise.resolve(l.value).then(r,i);h((o=o.apply(n,e)).next())});var R=require("cheerio-without-node-native"),z="1b3113663c9004682ed61086cf967c44",P="https://api.themoviedb.org/3",k="https://toonhub4u.co",T={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${k}/`};function $(s){return S(this,arguments,function*(n,e={},o=1e4){let t=new AbortController,r=setTimeout(()=>t.abort(),o);try{let i=yield fetch(n,y(x({},e),{signal:t.signal,redirect:"follow"}));return clearTimeout(r),i}catch(i){throw clearTimeout(r),i.name==="AbortError"?new Error(`Request timeout after ${o}ms`):i}})}function _(n){return n?n.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function V(n){return n?n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):""}function M(n,e){let o=_(n),s=_(e);if(o===s)return 1;if(o.length>5&&s.length>5&&(s.includes(o)||o.includes(s)))return .9;let t=new Set(o.split(/\s+/).filter(l=>l.length>2)),r=new Set(s.split(/\s+/).filter(l=>l.length>2));if(t.size===0||r.size===0)return 0;let i=new Set([...t].filter(l=>r.has(l))),h=new Set([...t,...r]);return i.size/h.size}function Y(n){if(!n)return null;let e=n.match(/S(\d+)E(\d+)/i);return e?{season:parseInt(e[1]),episode:parseInt(e[2])}:null}function J(n,e,o){let s=e.quality||"Unknown",t=V(n.title||"Unknown"),r=n.year?` (${n.year})`:"",i="";return o&&o.season&&o.episode?i=` - S${String(o.season).padStart(2,"0")}E${String(o.episode).padStart(2,"0")}`:e.label&&(i=` - ${e.label}`),`ToonHub (${s})
\u{1F4F9}: ${t}${r}${i}
\u{1F69C}: toonhub | \u{1F310}: HINDI/ENGLISH`}function N(n,e){return S(this,null,function*(){let s=`${P}/${e==="movie"?"movie":"tv"}/${n}?api_key=${z}`;try{let t=yield $(s,{},8e3);if(!t.ok)throw new Error(`HTTP ${t.status}`);let r=yield t.json();return{title:r.title||r.name,year:(r.release_date||r.first_air_date||"").split("-")[0]}}catch(t){throw console.warn("[ToonHub] TMDB details fetch failed:",t.message),t}})}function ee(n,e){return S(this,null,function*(){let s=`${P}/search/${e==="movie"?"movie":"tv"}?api_key=${z}&query=${encodeURIComponent(n)}`;try{let t=yield $(s,{},8e3);if(!t.ok)return null;let r=yield t.json();if(r.results&&r.results.length>0){let i=r.results[0];return{title:i.title||i.name,year:(i.release_date||i.first_air_date||"").split("-")[0]}}}catch(t){console.warn("[ToonHub] TMDB search failed:",t.message)}return null})}function te(n){return S(this,null,function*(){console.log(`[ToonHub] Searching for: "${n}"`);try{let e=`${k}/?s=${encodeURIComponent(n)}`,o=yield $(e,{headers:T},8e3);if(!o.ok)return[];let s=yield o.text(),t=R.load(s),r=[];return t("li.post-item").each((i,h)=>{let l=t(h).find("h2.post-title a"),d=l.text().trim().split("[")[0].trim(),c=l.attr("href");c&&r.push({title:d,href:c})}),console.log(`[ToonHub] Found ${r.length} results`),r}catch(e){return console.error("[ToonHub] Search error:",e.message),[]}})}function q(n){return S(this,null,function*(){console.log(`[ToonHub] Searching ToonStream for: "${n}"`);try{let e=`https://toonstream.one/home/?s=${encodeURIComponent(n)}`,o=yield $(e,{headers:T},1e4);if(!o.ok)return[];let s=yield o.text(),t=R.load(s),r=[];return t("article.post").each((i,h)=>{let l=t(h).find("a.lnk-blk"),d=t(h).find(".entry-title").text().trim(),c=l.attr("href");if(c){let m="unknown";c.includes("/series/")||c.includes("/anime/")?m="series":c.includes("/movies/")||c.includes("/movie/")?m="movie":c.includes("/episode/")&&(m="episode"),r.push({title:d,href:c,type:m})}}),console.log(`[ToonHub] Found ${r.length} results on ToonStream`),r}catch(e){return console.error("[ToonHub] ToonStream search error:",e.message),[]}})}function oe(n,e){return S(this,null,function*(){console.log(`[ToonHub] Getting episode ${e} from ToonStream: ${n}`);try{let o=yield $(n,{headers:T},1e4);if(!o.ok)return null;let s=yield o.text(),t=R.load(s),r=null,i=e.toString().padStart(2,"0"),h=new RegExp(`(?:Episode|Ep)\\s*(${e}|${i})\\b`,"i");return t("article.post.episodes").each((l,d)=>{let c=t(d).text();if(h.test(c))return r=t(d).find("a.lnk-blk").attr("href"),!1}),r||t('a[href*="/episode/"]').each((l,d)=>{let c=t(d).attr("href");if(c.includes(`-${e}/`)||c.includes(`-ep-${e}/`)||c.endsWith(`-${e}`)||c.endsWith(`-ep-${e}`))return r=c,!1}),r}catch(o){return console.error("[ToonHub] ToonStream episode fetch error:",o.message),null}})}function ne(n){return S(this,null,function*(){console.log(`[ToonHub] Extracting direct stream from: ${n}`);try{let e=n.replace(/&#038;/g,"&");if(e.includes("redirect/main")&&e.includes(".php?url=")){let o=e.split("url=")[1].split("&")[0];try{e=Buffer.from(o,"base64").toString("utf8"),console.log(`[ToonHub] Decoded redirect URL: ${e}`)}catch(s){console.log("[ToonHub] Base64 decode failed for URL")}}if(e.includes("toonstream.")&&e.includes("/episode/")){console.log(`[ToonHub] Resolving ToonStream episode page: ${e}`);let t=(yield(yield $(e,{headers:T},1e4)).text()).match(/https?:\/\/toonstream\.[^/]+\/home\/\?trembed=[^"']+/i);t&&(e=t[0].replace(/&#038;/g,"&"),console.log(`[ToonHub] Found Embed URL: ${e}`))}if(e.includes("toonstream.")&&e.includes("/home/")){console.log(`[ToonHub] Resolving ToonStream embed: ${e}`);let t=(yield(yield $(e,{headers:T},1e4)).text()).match(/<iframe[^>]+src="([^"]+)"/i);t&&t[1]&&(e=t[1].replace(/&#038;/g,"&"),console.log(`[ToonHub] Found internal host: ${e}`))}if(e.includes("short.icu")||e.includes("as-cdn21.top")||e.includes("abyss.to")){console.log(`[ToonHub] Extracting via Host API: ${e}`);let o=e.match(/\/(?:video|v)\/([a-zA-Z0-9]+)/)||e.match(/[\?&]v=([a-zA-Z0-9]+)/);if(o&&o[1]){let l=o[1],c=`${e.split("/video/")[0].split("/v/")[0]}/player/index.php?data=${l}&do=getVideo`;console.log(`[ToonHub] Calling Host API for ID: ${l}`);try{let m=yield $(c,{method:"POST",headers:y(x({},T),{Referer:"https://toonstream.one/","X-Requested-With":"XMLHttpRequest","Content-Type":"application/x-www-form-urlencoded"}),body:`hash=${l}&r=https://toonstream.one/`},1e4);if(m.ok){let v=yield m.json();if(v&&v.videoSource)return console.log(`[ToonHub] Successfully retrieved signed stream: ${v.videoSource}`),v.videoSource}}catch(m){console.warn(`[ToonHub] Host API call failed: ${m.message}`)}}let s=y(x({},T),{Referer:"https://toonstream.one/"}),r=yield(yield $(e,{headers:s},1e4)).text(),i=r.match(/https?:\/\/[^\s"']+\.m3u8[^\s"']*/i);if(i)return i[0].replace(/&#038;/g,"&");let h=r.match(/https?:\/\/[^\s"']+\.mp4[^\s"']*/i);if(h)return h[0].replace(/&#038;/g,"&")}if(e.includes("gdmirrorbot.nl")){console.log(`[ToonHub] Extracting from gdmirrorbot.nl: ${e}`);try{let t=(yield(yield $(e,{headers:y(x({},T),{Referer:"https://toonhub4u.co/"})},1e4)).text()).match(/const\s+fileurl\s*=\s*"([^"]+)"/);if(t&&t[1]){let r=t[1].replace(/\\/g,"");return console.log(`[ToonHub] Found direct URL from gdmirrorbot: ${r}`),r}}catch(o){console.warn(`[ToonHub] gdmirrorbot extraction failed: ${o.message}`)}}if(e.includes("/file/")||e.includes("/embed/")){let o=e.replace("/file/","/embed/"),t=yield(yield $(o,{headers:y(x({},T),{Referer:k})},1e4)).text(),r=t.match(/https?:\/\/[^\s"']+\.m3u8[^\s"']*/i);if(r)return r[0].replace(/&#038;/g,"&");let i=t.match(/https?:\/\/[^\s"']+\.mp4[^\s"']*/i);if(i)return i[0].replace(/&#038;/g,"&")}return e}catch(e){return console.error(`[ToonHub] Extraction failed for ${n}:`,e.message),n}})}function I(n,e,o,s){return S(this,null,function*(){console.log(`[ToonHub] Processing ${e} ${n} (S:${o}, E:${s})`);try{let t;if(/^\d+$/.test(n))try{t=yield N(n,e)}catch(a){t={title:n,year:null}}else try{t=(yield ee(n,e))||{title:n,year:null}}catch(a){t={title:n,year:null}}let r=yield te(t.title),i=null,h=0;for(let a of r){let u=M(t.title,a.title);if(e==="tv"&&o){let f=a.title.match(/Season\s*(\d+)/i);f?parseInt(f[1])===o?(u+=.2,console.log(`[ToonHub] Comparing "${t.title}" vs "${a.title}" - Score: ${(u-.2).toFixed(2)} + 0.2 (season match) = ${u.toFixed(2)}`)):(u-=.1,console.log(`[ToonHub] Comparing "${t.title}" vs "${a.title}" - Score: ${(u+.1).toFixed(2)} - 0.1 (wrong season) = ${u.toFixed(2)}`)):console.log(`[ToonHub] Comparing "${t.title}" vs "${a.title}" - Score: ${u.toFixed(2)}`)}else console.log(`[ToonHub] Comparing "${t.title}" vs "${a.title}" - Score: ${u.toFixed(2)}`);u>h&&(h=u,i=a)}if(!i||h<.4)return console.warn("[ToonHub] No good match found on ToonHub"),[];console.log(`[ToonHub] Best match: "${i.title}" (score: ${h.toFixed(2)})`);let l=yield q(i.title);l.length===0&&t.title!==i.title&&(l=yield q(t.title));let d=null,c=0;for(let a of l){let u=M(i.title,a.title),f=M(t.title,a.title),p=Math.max(u,f);a.type==="series"&&(p+=.1),console.log(`[ToonHub] ToonStream Compare: "${i.title}" vs "${a.title}" (${a.type}) - Score: ${p.toFixed(2)}`),p>c&&(c=p,d=a)}let m=[];if(d&&c>.45){console.log(`[ToonHub] Found matching series on ToonStream: ${d.title} (${d.type}, score: ${c.toFixed(2)})`);let a=d.type==="episode"?d.href:yield oe(d.href,s||1);a&&(console.log(`[ToonHub] Found direct ToonStream episode link: ${a}`),m.push({url:a,quality:"HD",label:`Episode ${s}`}))}let W=yield(yield $(i.href,{headers:T},8e3)).text(),w=R.load(W),U=w(".entry-content");if(e==="tv"&&s){let a=s.toString().padStart(2,"0"),u=new RegExp(`Episode\\s*(${s}|${a})`,"i");U.find("p, strong, span, h3").each((f,p)=>{let H=w(p).text();if(u.test(H)){let g=w(p),j=!1,C=0;for(;g.length&&C<5&&(g.find("a[href]").each((se,A)=>{var D;let b=w(A).attr("href"),G=((D=w(A).text().match(/\d+p/i))==null?void 0:D[0])||re(g.text())||"HD";if(b&&!b.includes("ads")&&!b.endsWith(".co/")&&!b.endsWith(".co")){if(b.includes("toonstream.net")||b.includes("redirect/main")){console.log(`[ToonHub] Skipping dead/unreliable redirect link: ${b}`);return}m.push({url:b,quality:G,label:`Episode ${s}`}),j=!0}}),g=g.next(),!(g.length&&/Episode\s*(\d+)/i.test(g.text())&&!u.test(g.text())));)C++}})}else U.find("a[href]").each((a,u)=>{var H;let f=w(u).attr("href"),p=w(u).text();if(f&&(f.includes("/file/")||f.includes("/embed/")||f.includes("drive.google.com")||f.includes("toonstream.")||f.includes("redirect/"))){if(f.includes("toonstream.net")||f.includes("redirect/main"))return;let g=((H=p.match(/\d+p/i))==null?void 0:H[0])||"HD";m.push({url:f,quality:g})}});let E=[],F=new Set;for(let a of m){if(F.has(a.url))continue;F.add(a.url);let u=yield ne(a.url);if(u){let f=u.match(/name=([^&]+)/),p=null,H=!0;if(f){let g=decodeURIComponent(f[1]);p=Y(g),e==="tv"&&o&&s&&p&&(p.season!==o||p.episode!==s)&&(console.log(`[ToonHub] Filtering out S${String(p.season).padStart(2,"0")}E${String(p.episode).padStart(2,"0")} (requested S${String(o).padStart(2,"0")}E${String(s).padStart(2,"0")})`),H=!1)}H&&E.push({name:"ToonHub",title:J(t,a,p),url:u,quality:a.quality,headers:{Referer:k,"User-Agent":T["User-Agent"]},provider:"ToonHub"})}if(E.length>=10)break}return E}catch(t){return console.error("[ToonHub] getStreams error:",t),[]}})}function re(n){return n.includes("1080p")?"1080p":n.includes("720p")?"720p":n.includes("480p")?"480p":null}typeof module!="undefined"&&module.exports?module.exports={getStreams:I}:global.getStreams={getStreams:I};
