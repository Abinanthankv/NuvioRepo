/**
 * tamilblasters - Built from src/tamilblasters/
 * Generated: 2026-01-10T08:54:55.689Z
 */
var J=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var O=(t,r,e)=>r in t?J(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,D=(t,r)=>{for(var e in r||(r={}))ee.call(r,e)&&O(t,e,r[e]);if(N)for(var e of N(r))te.call(r,e)&&O(t,e,r[e]);return t},F=(t,r)=>X(t,Z(r));var T=(t,r,e)=>new Promise((o,s)=>{var i=a=>{try{m(e.next(a))}catch(l){s(l)}},u=a=>{try{m(e.throw(a))}catch(l){s(l)}},m=a=>a.done?o(a.value):Promise.resolve(a.value).then(i,u);m((e=e.apply(t,r)).next())});var G=require("cheerio-without-node-native"),re="1b3113663c9004682ed61086cf967c44",se="https://api.themoviedb.org/3",$="https://www.1tamilblasters.business",k={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${$}/`};function z(o){return T(this,arguments,function*(t,r={},e=1e4){let s=new AbortController,i=setTimeout(()=>s.abort(),e);try{let u=yield fetch(t,F(D({},r),{signal:s.signal}));return clearTimeout(i),u}catch(u){throw clearTimeout(i),u.name==="AbortError"?new Error(`Request timeout after ${e}ms`):u}})}function j(t){return t?t.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function oe(t,r){let e=j(t),o=j(r);if(e===o)return 1;if(e.includes(o)||o.includes(e))return .9;let s=new Set(e.split(/\s+/).filter(a=>a.length>2)),i=new Set(o.split(/\s+/).filter(a=>a.length>2));if(s.size===0||i.size===0)return 0;let u=new Set([...s].filter(a=>i.has(a))),m=new Set([...s,...i]);return u.size/m.size}function le(t,r,e,o){for(;e--;)if(o[e]){let s=e.toString(r);t=t.replace(new RegExp("\\b"+s+"\\b","g"),o[e])}return t}function ne(t,r){if(!r||r.length===0)return[];let e=t.title.toLowerCase().replace(/[^a-z0-9]/g,""),o=t.year?parseInt(t.year):null,s=[];for(let i of r){let u=i.title.toLowerCase().replace(/[^a-z0-9]/g,""),m=oe(t.title,i.title),a=u.includes(e),l=!o||i.title.includes(o.toString())||i.title.includes((o+1).toString())||i.title.includes((o-1).toString());a&&l&&(m+=.5),m>.4&&(console.log(`[Tamilblasters] Match found: "${i.title}" (score: ${m.toFixed(2)})`),s.push(i))}return s}function ae(t,r){return T(this,null,function*(){let o=`${se}/${r==="movie"?"movie":"tv"}/${t}?api_key=${re}`;try{let i=yield(yield z(o,{},8e3)).json(),u={title:i.title||i.name,year:(i.release_date||i.first_air_date||"").split("-")[0]};return console.log(`[Tamilblasters] TMDB Info: "${u.title}" (${u.year||"N/A"})`),u}catch(s){throw console.error("[Tamilblasters] Error fetching TMDB metadata:",s.message),s}})}function ie(t){return T(this,null,function*(){let r=`${$}/?s=${encodeURIComponent(t)}`;console.log(`[Tamilblasters] Searching: ${r}`);try{let e=yield z(r,{headers:k},8e3);if(e.url&&!e.url.includes(new URL($).hostname))try{let u=new URL(e.url);u.protocol.startsWith("http")&&(console.log(`[Tamilblasters] Domain redirect detected: ${$} -> ${u.origin}`),$=u.origin,k.Referer=`${$}/`)}catch(u){}let o=yield e.text(),s=G.load(o),i=[];return s(".posts-wrapper article, .nv-index-posts article").each((u,m)=>{let a=s(m).find("h2.entry-title a"),l=a.text().trim(),h=a.attr("href");l&&h&&i.push({title:l,href:h})}),i}catch(e){return console.error("[Tamilblasters] Search error:",e.message),[]}})}function ce(t){return T(this,null,function*(){try{console.log(`[Tamilblasters] Embed URL: ${t}`);let e=new URL(t).hostname.toLowerCase();return console.log(`[Tamilblasters] Attempting universal extraction from: ${e}`),yield ue(t,e)}catch(r){return console.error(`[Tamilblasters] Extraction error: ${r.message}`),null}})}function ue(t,r){return T(this,null,function*(){try{let e=new URL(t).origin,s=yield(yield z(t,{headers:F(D({},k),{Referer:$})},5e3)).text();if(s.includes("<title>Loading...</title>")||s.includes("Page is loading")){console.log(`[Tamilblasters] Detected landing page on ${r}, trying mirrors...`);let a=["yuguaab.com","cavanhabg.com"];for(let l of a){if(r.includes(l))continue;let h=t.replace(r,l);console.log(`[Tamilblasters] Trying mirror: ${h}`);try{let n=yield(yield z(h,{headers:F(D({},k),{Referer:$})},3e3)).text();if(n.includes("jwplayer")||n.includes("sources")||n.includes("eval(function(p,a,c,k,e,d)")){console.log(`[Tamilblasters] Successfully reached player on mirror: ${l}`),s=n;break}}catch(c){console.log(`[Tamilblasters] Mirror ${l} failed: ${c.message}`)}}}let i=s.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(i){console.log(`[Tamilblasters] Detected Packer obfuscation on ${r}, unpacking...`);let l=i[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(l){let h=le(l[1],parseInt(l[2]),parseInt(l[3]),l[4].split("|"));s+=`
`+h}}let u=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi,/https?:\/\/[^\s"']+\.mp4[^\s"']*/gi,/(?:source|file|src)\s*[:=]\s*["']([^"']+\.(?:m3u8|mp4)[^"']*)["']/gi],m=[];for(let a of u){let l=s.match(a);if(l&&l.length>0)for(let h of l){let c=h,n=h.match(/["']:[ ]*["']([^"']+)["']/);if(n)c=n[1];else{let S=h.match(/["']([^"']+)["']/);S&&(c=S[1])}let b=c.match(/https?:\/\/[^\s"']+/);b&&(c=b[0]),c=c.replace(/[\\"'\)\]]+$/,""),!(!c||c.length<5||c.includes("google.com")||c.includes("youtube.com"))&&(c.startsWith("/")&&!c.startsWith("//")&&(c=e+c),m.push(c))}}if(m.length>0){m.sort((l,h)=>{let c=l.includes("?"),n=h.includes("?");if(c!==n)return n?1:-1;let b=l.toLowerCase().includes(".m3u8"),S=h.toLowerCase().includes(".m3u8");return b!==S?S?1:-1:l.length-h.length});let a=m[0];return console.log(`[Tamilblasters] Selected best direct URL from ${r}: ${a}`),a}return console.log(`[Tamilblasters] No direct URL found in ${r}, skipping`),null}catch(e){return console.error(`[Tamilblasters] Error extracting from ${r}: ${e.message}`),null}})}function V(t,r="movie",e=null,o=null){return T(this,null,function*(){console.log(`[Tamilblasters] Processing ${r} ${t}`);try{let s;if(/^\d+$/.test(t))try{s=yield ae(t,r)}catch(n){console.log(`[Tamilblasters] TMDB fetch failed, using "${t}" as search query`),s={title:t,year:null}}else console.log(`[Tamilblasters] Using "${t}" as search query directly`),s={title:t,year:null};let u=yield ie(s.title),m=ne(s,u);if(m.length===0)return console.warn("[Tamilblasters] No matching titles found in search results"),[];let a=[],l=new Set;for(let n of m)l.has(n.href)||(l.add(n.href),a.push(n));let h=a.slice(0,3);console.log(`[Tamilblasters] Processing top ${h.length} unique matches out of ${m.length} total`);let c=[];for(let n of h){console.log(`[Tamilblasters] Processing match: ${n.title} -> ${n.href}`);try{let S=yield(yield z(n.href,{headers:k},8e3)).text(),v=G.load(S),Y=v("h1.entry-title").text().trim()||n.title;console.log(`[Tamilblasters] Full Page Title: ${Y}`);let B=[];v("iframe").each((d,g)=>{let y=v(g).attr("src");if(!y||y.includes("google.com")||y.includes("youtube.com"))return;let E="",w=v(g);for(let f=0;f<5;f++){let A=w.prev();if(A.length===0){if(w=w.parent(),w.is("body")||w.length===0)break;continue}let x=A.text().trim();if(x.toLowerCase().includes("episode")){E=x.replace(/[\r\n]+/g," ").trim();break}w=A}let C=E||v(g).closest("div").prev("p").text().trim()||"Stream "+(d+1),p=n.title,M=p.match(/^(.*?)\s*\((\d{4})\)\s*(.*)$/),U=p,P="",q="";if(M)U=M[1].trim(),P=`(${M[2]})`,q=M[3].trim()||"Original";else{let f=p.match(/^(.*?)\s*\(([^)]+)\)$/);f&&(U=f[1].trim(),q=f[2].trim())}let L=C;if(C.toLowerCase().includes("episode")){let f=C.match(/Episode\s*[–-ー]\s*(\d+)/i)||C.match(/Episode\s*(\d+)/i);f&&(L=`EP${f[1]}`)}let H;if(r==="tv"||p.match(/S\d+.*EP/i)||p.match(/Season.*Episode/i)||L.match(/EP\s*\d+/i)||L.match(/Episode\s*\d+/i)){let f=p.match(/S(\d+)/i),A=f?`s${f[1].padStart(2,"0")}`:"s01",x=null,I=L.match(/EP\s*(\d+)/i)||L.match(/Episode\s*(\d+)/i);if(I)x=I[1];else{let K=p.match(/EP\s*(\d+)/i);K&&(x=K[1])}let Q=x?`e${x.padStart(2,"0")}`:L,_=q.replace(/S\d+/gi,"").replace(/EP\s*\(.*?\)/gi,"").replace(/EP\d+/gi,"").replace(/\s+/g," ").trim();_=_.replace(/^[-\s,[\]]+|[-\s,[\]]+$/g,"").trim(),H=`${U}${P}-${A} ${Q}${_?" - "+_:""}`}else H=`${U}${P}${q?"-"+q:""} (${L})`;B.push({title:H,url:y})});let W=B.slice(0,5);B.length>5&&console.log(`[Tamilblasters] Limiting to first 5 iframes out of ${B.length} for performance`),console.log(`[Tamilblasters] Extracting direct streams from ${W.length} embed URLs for "${n.title}"...`);let R=(yield Promise.all(W.map(d=>T(this,null,function*(){try{let g=yield Promise.race([ce(d.url),new Promise((y,E)=>setTimeout(()=>E(new Error("Extraction timeout after 5 seconds")),5e3))]);return g?F(D({},d),{url:g,quality:"Unknown"}):null}catch(g){return console.error(`[Tamilblasters] Failed to extract stream: ${g.message}`),null}})))).filter(d=>d!==null);if(e!==null||o!==null){let d=o!==null?`EP${o.toString().padStart(2,"0")}`:null,g=o!==null?`e${o.toString().padStart(2,"0")}`:null,y=o!==null?`e ${o.toString().padStart(2,"0")}`:null,E=e!==null?`S${e.toString().padStart(2,"0")}`:null,w=e!==null?`s${e.toString().padStart(2,"0")}`:null;if(!E||n.title.toUpperCase().includes(E)||n.title.toLowerCase().includes(w)){let p=R.filter(M=>{if(!d)return!0;let U=M.title.toUpperCase(),P=M.title.toLowerCase();return U.includes(d)||P.includes(g)||P.includes(y)||U.includes(`EPISODE ${o}`)});R=p,p.length>0?console.log(`[Tamilblasters] Filtered to ${R.length} streams for episode ${o}`):console.log(`[Tamilblasters] No streams found matching epsiode ${o}`)}else R=[]}if(console.log(`[Tamilblasters] Successfully extracted ${R.length} direct streams for "${n.title}"`),c.push(...R),c.length>=10){console.log(`[Tamilblasters] Found ${c.length} streams, stopping early`);break}}catch(b){console.error(`[Tamilblasters] Failed to process match ${n.title}:`,b.message)}}return c.map(n=>({name:"Tamilblasters",title:n.title,url:n.url,quality:n.quality||"Unknown",headers:{Referer:$,"User-Agent":k["User-Agent"]},provider:"Tamilblasters"}))}catch(s){return console.error("[Tamilblasters] getStreams failed:",s.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:V}:global.getStreams={getStreams:V};
