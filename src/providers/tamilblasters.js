/**
 * tamilblasters - Built from src/tamilblasters/
 * Generated: 2026-01-11T05:23:23.695Z
 */
var J=Object.defineProperty,Z=Object.defineProperties;var tt=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,st=Object.prototype.propertyIsEnumerable;var X=(e,s,t)=>s in e?J(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,A=(e,s)=>{for(var t in s||(s={}))et.call(s,t)&&X(e,t,s[t]);if(O)for(var t of O(s))st.call(s,t)&&X(e,t,s[t]);return e},C=(e,s)=>Z(e,tt(s));var y=(e,s,t)=>new Promise((l,r)=>{var u=a=>{try{h(t.next(a))}catch(o){r(o)}},i=a=>{try{h(t.throw(a))}catch(o){r(o)}},h=a=>a.done?l(a.value):Promise.resolve(a.value).then(u,i);h((t=t.apply(e,s)).next())});var G=require("cheerio-without-node-native"),rt="1b3113663c9004682ed61086cf967c44",nt="https://api.themoviedb.org/3",w="https://www.1tamilblasters.business",x={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${w}/`};function P(l){return y(this,arguments,function*(e,s={},t=1e4){let r=new AbortController,u=setTimeout(()=>r.abort(),t);try{let i=yield fetch(e,C(A({},s),{signal:r.signal}));return clearTimeout(u),i}catch(i){throw clearTimeout(u),i.name==="AbortError"?new Error(`Request timeout after ${t}ms`):i}})}function j(e){return e?e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function ot(e,s){let t=j(e),l=j(s);if(t===l)return 1;if(t.includes(l)||l.includes(t))return .9;let r=new Set(t.split(/\s+/).filter(a=>a.length>2)),u=new Set(l.split(/\s+/).filter(a=>a.length>2));if(r.size===0||u.size===0)return 0;let i=new Set([...r].filter(a=>u.has(a))),h=new Set([...r,...u]);return i.size/h.size}function lt(e,s,t,l){for(;t--;)if(l[t]){let r=t.toString(s);e=e.replace(new RegExp("\\b"+r+"\\b","g"),l[t])}return e}function at(e,s){if(!s||s.length===0)return[];let t=e.title.toLowerCase().replace(/[^a-z0-9]/g,""),l=e.year?parseInt(e.year):null,r=[];for(let u of s){let i=u.title.toLowerCase().replace(/[^a-z0-9]/g,""),h=ot(e.title,u.title),a=i.includes(t),o=!l||u.title.includes(l.toString())||u.title.includes((l+1).toString())||u.title.includes((l-1).toString());a&&o&&(h+=.5),h>.4&&(console.log(`[Tamilblasters] Match found: "${u.title}" (score: ${h.toFixed(2)})`),r.push(u))}return r}function it(e,s){return y(this,null,function*(){let l=`${nt}/${s==="movie"?"movie":"tv"}/${e}?api_key=${rt}`;try{let u=yield(yield P(l,{},8e3)).json(),i={title:u.title||u.name,year:(u.release_date||u.first_air_date||"").split("-")[0]};return console.log(`[Tamilblasters] TMDB Info: "${i.title}" (${i.year||"N/A"})`),i}catch(r){throw console.error("[Tamilblasters] Error fetching TMDB metadata:",r.message),r}})}function ct(e){return y(this,null,function*(){let s=`${w}/?s=${encodeURIComponent(e)}`;console.log(`[Tamilblasters] Searching: ${s}`);try{let t=yield P(s,{headers:x},8e3);if(t.url&&!t.url.includes(new URL(w).hostname))try{let i=new URL(t.url);i.protocol.startsWith("http")&&(console.log(`[Tamilblasters] Domain redirect detected: ${w} -> ${i.origin}`),w=i.origin,x.Referer=`${w}/`)}catch(i){}let l=yield t.text(),r=G.load(l),u=[];return r(".posts-wrapper article, .nv-index-posts article").each((i,h)=>{let a=r(h).find("h2.entry-title a"),o=a.text().trim(),m=a.attr("href");o&&m&&u.push({title:o,href:m})}),u}catch(t){return console.error("[Tamilblasters] Search error:",t.message),[]}})}function ut(e){return y(this,null,function*(){try{let t=yield(yield P(e,{headers:C(A({},x),{Referer:w})},5e3)).text();if(!t.includes("#EXTM3U"))return[{url:e,quality:"Unknown"}];let l=[];if(t.includes("#EXT-X-STREAM-INF")){let i=t.split(`
`);for(let h=0;h<i.length;h++){let a=i[h].trim();if(a.startsWith("#EXT-X-STREAM-INF")){let o="Unknown",m=a.match(/RESOLUTION=(\d+)x(\d+)/i);if(m){let n=parseInt(m[2]);n>=2160?o="4K":n>=1080?o="1080p":n>=720?o="720p":n>=480?o="480p":o=`${n}p`}if(h+1<i.length){let n=i[h+1].trim();n&&!n.startsWith("#")&&(n.startsWith("http")||(n=e.substring(0,e.lastIndexOf("/")+1)+n),l.push({url:n,quality:o}))}}}}if(l.length>0){let i={"4K":2160,"1080p":1080,"720p":720,"480p":480,Unknown:0};return l.sort((h,a)=>{let o=i[h.quality]||parseInt(h.quality)||0;return(i[a.quality]||parseInt(a.quality)||0)-o}),l}let r=t.match(/\b(2160p|1080p|720p|480p|4K|UHD|HD)\b/i),u=r?r[0]:"Unknown";return[{url:e,quality:u}]}catch(s){return console.error(`[Tamilblasters] Error detecting quality from m3u8: ${s.message}`),[{url:e,quality:"Unknown"}]}})}function ht(e){return y(this,null,function*(){try{console.log(`[Tamilblasters] Embed URL: ${e}`);let t=new URL(e).hostname.toLowerCase();return console.log(`[Tamilblasters] Attempting universal extraction from: ${t}`),yield mt(e,t)}catch(s){return console.error(`[Tamilblasters] Extraction error: ${s.message}`),[]}})}function mt(e,s){return y(this,null,function*(){try{let t=new URL(e).origin,r=yield(yield P(e,{headers:C(A({},x),{Referer:w})},5e3)).text();if(r.includes("<title>Loading...</title>")||r.includes("Page is loading")){console.log(`[Tamilblasters] Detected landing page on ${s}, trying mirrors...`);let a=["yuguaab.com","cavanhabg.com"];for(let o of a){if(s.includes(o))continue;let m=e.replace(s,o);try{let c=yield(yield P(m,{headers:C(A({},x),{Referer:w})},3e3)).text();if(c.includes("jwplayer")||c.includes("sources")||c.includes("eval(function(p,a,c,k,e,d)")){r=c;break}}catch(n){}}}let u=r.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(u){let o=u[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(o){let m=lt(o[1],parseInt(o[2]),parseInt(o[3]),o[4].split("|"));r+=`
`+m}}let i=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi],h=[];for(let a of i){let o=r.match(a);if(o)for(let m of o){let n=m,c=m.match(/["']:[ ]*["']([^"']+)["']/);if(c)n=c[1];else{let b=m.match(/["']([^"']+)["']/);b&&(n=b[1])}let T=n.match(/https?:\/\/[^\s"']+/);T&&(n=T[0]),n=n.replace(/[\\"'\)\]]+$/,""),!(!n||n.length<5||n.includes("google.com")||n.includes("youtube.com"))&&(n.startsWith("/")&&!n.startsWith("//")&&(n=t+n),h.push(n))}}if(h.length>0){h.sort((o,m)=>{let n=o.includes("?"),c=m.includes("?");if(n!==c)return c?1:-1;let T=o.toLowerCase().includes(".m3u8"),b=m.toLowerCase().includes(".m3u8");return T!==b?b?1:-1:o.length-m.length});let a=h[0];return console.log(`[Tamilblasters] Detected best URL: ${a}. Resolving quality...`),yield ut(a)}return[]}catch(t){return console.error(`[Tamilblasters] Error extracting from ${s}: ${t.message}`),[]}})}function V(e,s="movie",t=null,l=null){return y(this,null,function*(){console.log(`[Tamilblasters] Processing ${s} ${e}`);try{let r;if(/^\d+$/.test(e))try{r=yield it(e,s)}catch(c){console.log(`[Tamilblasters] TMDB fetch failed, using "${e}" as search query`),r={title:e,year:null}}else console.log(`[Tamilblasters] Using "${e}" as search query directly`),r={title:e,year:null};let i=yield ct(r.title),h=at(r,i);if(h.length===0)return console.warn("[Tamilblasters] No matching titles found in search results"),[];let a=[],o=new Set;for(let c of h)o.has(c.href)||(o.add(c.href),a.push(c));let m=a.slice(0,3);console.log(`[Tamilblasters] Processing top ${m.length} unique matches out of ${h.length} total`);let n=[];for(let c of m){console.log(`[Tamilblasters] Processing match: ${c.title} -> ${c.href}`);try{let b=yield(yield P(c.href,{headers:x},8e3)).text(),k=G.load(b),Y=k("h1.entry-title").text().trim()||c.title;console.log(`[Tamilblasters] Full Page Title: ${Y}`);let W=[];k("iframe").each((S,g)=>{let p=k(g).attr("src");if(!p||p.includes("google.com")||p.includes("youtube.com"))return;let E="",$=k(g);for(let f=0;f<5;f++){let B=$.prev();if(B.length===0){if($=$.parent(),$.is("body")||$.length===0)break;continue}let q=B.text().trim();if(q.toLowerCase().includes("episode")){E=q.replace(/[\r\n]+/g," ").trim();break}$=B}let D=E||k(g).closest("div").prev("p").text().trim()||"Stream "+(S+1),d=c.title,M=d.match(/^(.*?)\s*\((\d{4})\)\s*(.*)$/),U=d,v="",F="";if(M)U=M[1].trim(),v=`(${M[2]})`,F=M[3].trim()||"Original";else{let f=d.match(/^(.*?)\s*\(([^)]+)\)$/);f&&(U=f[1].trim(),F=f[2].trim())}let L=D;if(D.toLowerCase().includes("episode")){let f=D.match(/Episode\s*[–-ー]\s*(\d+)/i)||D.match(/Episode\s*(\d+)/i);f&&(L=`EP${f[1]}`)}let I;if(s==="tv"||d.match(/S\d+.*EP/i)||d.match(/Season.*Episode/i)||L.match(/EP\s*\d+/i)||L.match(/Episode\s*\d+/i)){let f=d.match(/S(\d+)/i),B=f?`s${f[1].padStart(2,"0")}`:"s01",q=null,H=L.match(/EP\s*(\d+)/i)||L.match(/Episode\s*(\d+)/i);if(H)q=H[1];else{let K=d.match(/EP\s*(\d+)/i);K&&(q=K[1])}let Q=q?`e${q.padStart(2,"0")}`:L,z=F.replace(/S\d+/gi,"").replace(/EP\s*\(.*?\)/gi,"").replace(/EP\d+/gi,"").replace(/\s+/g," ").trim();z=z.replace(/^[-\s,[\]]+|[-\s,[\]]+$/g,"").trim(),I=`${U}${v}-${B} ${Q}${z?" - "+z:""}`}else I=`${U}${v}${F?"-"+F:""} (${L})`;W.push({title:I,url:p})});let _=W.slice(0,5);W.length>5&&console.log(`[Tamilblasters] Limiting to first 5 iframes out of ${W.length} for performance`),console.log(`[Tamilblasters] Extracting direct streams from ${_.length} embed URLs for "${c.title}"...`);let N=[];for(let S of _)try{let g=yield Promise.race([ht(S.url),new Promise((p,E)=>setTimeout(()=>E(new Error("Extraction timeout after 5 seconds")),5e3))]);if(g&&g.length>0)for(let p of g)N.push(C(A({},S),{url:p.url,quality:p.quality}))}catch(g){console.error(`[Tamilblasters] Failed to extract stream: ${g.message}`)}let R=N;if(t!==null||l!==null){let S=l!==null?`EP${l.toString().padStart(2,"0")}`:null,g=l!==null?`e${l.toString().padStart(2,"0")}`:null,p=l!==null?`e ${l.toString().padStart(2,"0")}`:null,E=t!==null?`S${t.toString().padStart(2,"0")}`:null,$=t!==null?`s${t.toString().padStart(2,"0")}`:null;if(!E||c.title.toUpperCase().includes(E)||c.title.toLowerCase().includes($)){let d=R.filter(M=>{if(!S)return!0;let U=M.title.toUpperCase(),v=M.title.toLowerCase();return U.includes(S)||v.includes(g)||v.includes(p)||U.includes(`EPISODE ${l}`)});R=d,d.length>0?console.log(`[Tamilblasters] Filtered to ${R.length} streams for episode ${l}`):console.log(`[Tamilblasters] No streams found matching epsiode ${l}`)}else R=[]}if(console.log(`[Tamilblasters] Successfully extracted ${R.length} direct streams for "${c.title}"`),n.push(...R),n.length>=10){console.log(`[Tamilblasters] Found ${n.length} streams, stopping early`);break}}catch(T){console.error(`[Tamilblasters] Failed to process match ${c.title}:`,T.message)}}return n.map(c=>({name:"Tamilblasters",title:c.title,url:c.url,quality:c.quality||"Unknown",headers:{Referer:w,"User-Agent":x["User-Agent"]},provider:"Tamilblasters"}))}catch(r){return console.error("[Tamilblasters] getStreams failed:",r.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:V}:global.getStreams={getStreams:V};
