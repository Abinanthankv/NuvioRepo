/**
 * tamilblasters - Built from src/tamilblasters/
 * Generated: 2026-01-12T12:10:32.892Z
 */
var tt=Object.defineProperty,et=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var rt=Object.prototype.hasOwnProperty,at=Object.prototype.propertyIsEnumerable;var G=(t,s,e)=>s in t?tt(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,R=(t,s)=>{for(var e in s||(s={}))rt.call(s,e)&&G(t,e,s[e]);if(Y)for(var e of Y(s))at.call(s,e)&&G(t,e,s[e]);return t},C=(t,s)=>et(t,st(s));var x=(t,s,e)=>new Promise((i,n)=>{var a=l=>{try{m(e.next(l))}catch(r){n(r)}},h=l=>{try{m(e.throw(l))}catch(r){n(r)}},m=l=>l.done?i(l.value):Promise.resolve(l.value).then(a,h);m((e=e.apply(t,s)).next())});var Z=require("cheerio-without-node-native"),nt="1b3113663c9004682ed61086cf967c44",it="https://api.themoviedb.org/3",S="https://www.1tamilblasters.business",N={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${S}/`};function I(i){return x(this,arguments,function*(t,s={},e=1e4){let n=new AbortController,a=setTimeout(()=>n.abort(),e);try{let h=yield fetch(t,C(R({},s),{signal:n.signal}));return clearTimeout(a),h}catch(h){throw clearTimeout(a),h.name==="AbortError"?new Error(`Request timeout after ${e}ms`):h}})}function lt(t){return t?t.replace(/\w\S*/g,s=>s.charAt(0).toUpperCase()+s.substr(1).toLowerCase()):""}function Q(t){return t?t.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function ot(t,s){let e=Q(t),i=Q(s);if(e===i)return 1;if(e.includes(i)||i.includes(e))return .9;let n=new Set(e.split(/\s+/).filter(l=>l.length>2)),a=new Set(i.split(/\s+/).filter(l=>l.length>2));if(n.size===0||a.size===0)return 0;let h=new Set([...n].filter(l=>a.has(l))),m=new Set([...n,...a]);return h.size/m.size}function ct(t,s,e,i){for(;e--;)if(i[e]){let n=e.toString(s);t=t.replace(new RegExp("\\b"+n+"\\b","g"),i[e])}return t}function ut(t,s){if(!s||s.length===0)return[];let e=t.title.toLowerCase().replace(/[^a-z0-9]/g,""),i=t.year?parseInt(t.year):null,n=[];for(let a of s){let h=a.title.toLowerCase().replace(/[^a-z0-9]/g,""),m=ot(t.title,a.title),l=h.includes(e),r=!i||a.title.includes(i.toString())||a.title.includes((i+1).toString())||a.title.includes((i-1).toString());l&&r&&(m+=.5),m>.4&&(console.log(`[Tamilblasters] Match found: "${a.title}" (score: ${m.toFixed(2)})`),n.push(a))}return n}function ht(t,s){let{title:e,year:i}=t,{quality:n,type:a,size:h,language:m,seasonCode:l,episodeCode:r,label:c,baseTitle:o}=s,f=e.toLowerCase()===o.toLowerCase()||e===e.toLowerCase()?o:e,u=i||s.year,p=u?` (${u})`:"",d=!!(l||r),w=`\u{1F4FC}: ${f}${p}`;d?w+=` - ${l||"S01"} ${r||""}`:c&&!c.includes("Stream")&&(w+=` (${c})`),w+=` - ${n!=="Unknown"?n:""}`;let P=a&&a!=="UNKNOWN"?`\u{1F4FA}: ${a}
`:"",E=h&&h!=="UNKNOWN"?`\u{1F4BE}: ${h} | \u{1F69C}: tamilblasters
`:"",T=m||"TAMIL";return s.audioInfo&&(T=s.audioInfo),`Tamilblasters (Instant) (${n})
${P}${w}
${E}\u{1F310}: ${T.toUpperCase()}`}function ft(t,s){return x(this,null,function*(){let i=`${it}/${s==="movie"?"movie":"tv"}/${t}?api_key=${nt}`;try{let a=yield(yield I(i,{},8e3)).json(),h={title:a.title||a.name,year:(a.release_date||a.first_air_date||"").split("-")[0]};return console.log(`[Tamilblasters] TMDB Info: "${h.title}" (${h.year||"N/A"})`),h}catch(n){throw console.error("[Tamilblasters] Error fetching TMDB metadata:",n.message),n}})}function mt(t){return x(this,null,function*(){let s=`${S}/?s=${encodeURIComponent(t)}`;console.log(`[Tamilblasters] Searching: ${s}`);try{let e=yield I(s,{headers:N},8e3);if(e.url&&!e.url.includes(new URL(S).hostname))try{let h=new URL(e.url);h.protocol.startsWith("http")&&(console.log(`[Tamilblasters] Domain redirect detected: ${S} -> ${h.origin}`),S=h.origin,N.Referer=`${S}/`)}catch(h){}let i=yield e.text(),n=Z.load(i),a=[];return n(".posts-wrapper article, .nv-index-posts article").each((h,m)=>{let l=n(m).find("h2.entry-title a"),r=l.text().trim(),c=l.attr("href");r&&c&&a.push({title:r,href:c})}),a}catch(e){return console.error("[Tamilblasters] Search error:",e.message),[]}})}function pt(t){return x(this,null,function*(){try{let e=yield(yield I(t,{headers:C(R({},N),{Referer:S})},5e3)).text();if(!e.includes("#EXTM3U"))return{variants:[{url:t,quality:"Unknown"}],audios:[],isMaster:!1,masterUrl:t};let i=[],n=[],a=!1,h=e.matchAll(/#EXT-X-MEDIA:TYPE=AUDIO.*?NAME="([^"]+)"(?:.*?CHANNELS="([^"]+)")?/g);for(let r of h){let c=r[1],o=r[2];o&&(c+=` (${{1:"1.0",2:"2.0",6:"5.1",8:"7.1"}[o]||o})`),n.includes(c)||n.push(c)}if(e.includes("#EXT-X-STREAM-INF")){a=!0;let r=e.split(`
`);for(let c=0;c<r.length;c++){let o=r[c].trim();if(o.includes("#EXT-X-STREAM-INF")){let f="Unknown",u=o.match(/RESOLUTION=(\d+)x(\d+)/i);if(u){let d=parseInt(u[2]);d>=2160?f="4K":d>=1080?f="1080p":d>=720?f="720p":d>=480?f="480p":f=`${d}p`}let p=c+1;for(;p<r.length&&(r[p].trim().startsWith("#")||!r[p].trim());)p++;if(p<r.length){let d=r[p].trim();d&&!d.startsWith("#")&&(d.startsWith("http")||(d=t.substring(0,t.lastIndexOf("/")+1)+d),i.push({url:d,quality:f}))}c=p}}}if(i.length>0){let r={"4K":2160,"1080p":1080,"720p":720,"480p":480,Unknown:0};return i.sort((c,o)=>(r[o.quality]||0)-(r[c.quality]||0)),{variants:i,audios:n,isMaster:a,masterUrl:t}}let m=e.match(/\b(2160p|1080p|720p|480p|4K|UHD|HD)\b/i),l=m?m[0]:"Unknown";return{variants:[{url:t,quality:l}],audios:n,isMaster:!1,masterUrl:t}}catch(s){return console.error(`[Tamilblasters] Error detecting quality: ${s.message}`),{variants:[{url:t,quality:"Unknown"}],audios:[],isMaster:!1,masterUrl:t}}})}function dt(t){return x(this,null,function*(){try{console.log(`[Tamilblasters] Embed URL: ${t}`);let e=new URL(t).hostname.toLowerCase();return console.log(`[Tamilblasters] Attempting universal extraction from: ${e}`),yield gt(t,e)}catch(s){return console.error(`[Tamilblasters] Extraction error: ${s.message}`),[]}})}function gt(t,s){return x(this,null,function*(){try{let e=new URL(t).origin,n=yield(yield I(t,{headers:C(R({},N),{Referer:S})},5e3)).text();if(n.includes("<title>Loading...</title>")||n.includes("Page is loading")){console.log(`[Tamilblasters] Detected landing page on ${s}, trying mirrors...`);let l=["yuguaab.com","cavanhabg.com"];for(let r of l){if(s.includes(r))continue;let c=t.replace(s,r);try{let f=yield(yield I(c,{headers:C(R({},N),{Referer:S})},3e3)).text();if(f.includes("jwplayer")||f.includes("sources")||f.includes("eval(function(p,a,c,k,e,d)")){n=f;break}}catch(o){}}}let a=n.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(a){let r=a[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(r){let c=ct(r[1],parseInt(r[2]),parseInt(r[3]),r[4].split("|"));n+=`
`+c}}let h=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi],m=[];for(let l of h){let r=n.match(l);if(r)for(let c of r){let o=c,f=c.match(/["']:[ ]*["']([^"']+)["']/);if(f)o=f[1];else{let p=c.match(/["']([^"']+)["']/);p&&(o=p[1])}let u=o.match(/https?:\/\/[^\s"']+/);u&&(o=u[0]),o=o.replace(/[\\"'\)\]]+$/,""),!(!o||o.length<5||o.includes("google.com")||o.includes("youtube.com"))&&(o.startsWith("/")&&!o.startsWith("//")&&(o=e+o),m.push(o))}}if(m.length>0){m.sort((r,c)=>{let o=r.includes("?"),f=c.includes("?");if(o!==f)return f?1:-1;let u=r.toLowerCase().includes(".m3u8"),p=c.toLowerCase().includes(".m3u8");return u!==p?p?1:-1:r.length-c.length});let l=m[0];return console.log(`[Tamilblasters] Detected best URL: ${l}. Resolving quality...`),yield pt(l)}return[]}catch(e){return console.error(`[Tamilblasters] Error extracting from ${s}: ${e.message}`),[]}})}function J(t,s="movie",e=null,i=null){return x(this,null,function*(){var n;console.log(`[Tamilblasters] Processing ${s} ${t}`);try{let a;if(/^\d+$/.test(t))try{a=yield ft(t,s)}catch(u){console.log(`[Tamilblasters] TMDB fetch failed, using "${t}" as search query`),a={title:t,year:null}}else console.log(`[Tamilblasters] Using "${t}" as search query indirectly`),a={title:lt(t),year:null};let m=yield mt(a.title),l=ut(a,m);if(l.length===0)return console.warn("[Tamilblasters] No matching titles found in search results"),[];let r=[],c=new Set;for(let u of l)c.has(u.href)||(c.add(u.href),r.push(u));let o=r.slice(0,3);console.log(`[Tamilblasters] Processing top ${o.length} unique matches out of ${l.length} total`);let f=[];for(let u of o){console.log(`[Tamilblasters] Processing match: ${u.title} -> ${u.href}`);try{let d=yield(yield I(u.href,{headers:N},8e3)).text(),w=Z.load(d),P=w("h1.entry-title").text().trim()||u.title;console.log(`[Tamilblasters] Full Page Title: ${P}`);let E=[],T=u.title,F=T.match(/[\(\[](\d{4})[\)\]]/),K=T,_="",X="Original";F&&(_=F[1],K=T.split(F[0])[0].trim(),X=((n=T.split(F[0])[1])==null?void 0:n.trim())||"Original"),w("iframe").each((M,g)=>{let b=w(g).attr("src");if(!b||b.includes("google.com")||b.includes("youtube.com"))return;let y="",U=w(g);for(let q=0;q<5;q++){let v=U.prev();if(v.length===0){if(U=U.parent(),U.is("body")||U.length===0)break;continue}let B=v.text().trim();if(B.toLowerCase().includes("episode")){y=B.replace(/[\r\n]+/g," ").trim();break}U=v}let $=y||w(g).closest("div").prev("p").text().trim()||"Stream "+(M+1);if($.toLowerCase().includes("episode")){let q=$.match(/Episode\s*[–-ー]\s*(\d+)/i)||$.match(/Episode\s*(\d+)/i);q&&($=`EP${q[1]}`)}let O=s==="tv"||T.match(/S\d+.*EP/i)||T.match(/Season.*Episode/i)||$.match(/EP\s*\d+/i)||$.match(/Episode\s*\d+/i),W="",z="",L=X;if(O){let q=T.match(/S(\d+)/i);W=q?`S${q[1].padStart(2,"0")}`:"S01";let v=null,B=$.match(/EP\s*(\d+)/i)||$.match(/Episode\s*(\d+)/i);if(B)v=B[1];else{let V=T.match(/EP\s*(\d+)/i);V&&(v=V[1])}z=v?`E${v.padStart(2,"0")}`:$,L=L.replace(/S\d+/gi,"").replace(/EP\s*\(.*?\)/gi,"").replace(/EP\d+/gi,"").replace(/\s+/g," ").trim(),L=L.replace(/^[-\s,[\]]+|[-\s,[\]]+$/g,"").trim()}let k="UNKNOWN",A=(P+" "+$).toLowerCase();A.includes("bluray")||A.includes("brrip")?k="BluRay":A.includes("web-dl")||A.includes("webdl")?k="WEB-DL":A.includes("webrip")?k="WEBRip":A.includes("hdrip")?k="HDRip":A.includes("dvdrip")&&(k="DVDRip"),E.push({baseTitle:K,year:_,language:L,seasonCode:W,episodeCode:z,type:k,url:b,label:$,matchTitle:u.title})});let j=E.slice(0,5);E.length>5&&console.log(`[Tamilblasters] Limiting to first 5 iframes out of ${E.length} for performance`),console.log(`[Tamilblasters] Extracting direct streams from ${j.length} embed URLs for "${u.title}"...`);let H=[];for(let M of j)try{let g=yield Promise.race([dt(M.url),new Promise((b,y)=>setTimeout(()=>y(new Error("Extraction timeout after 5 seconds")),5e3))]);if(g&&g.variants&&g.variants.length>0){let b=g.audios.length>0?g.audios.join(", "):"";if(g.isMaster&&g.audios.length>1){let y=g.variants[0].quality;H.push(C(R({},M),{url:g.masterUrl,quality:y,audioInfo:b,isMaster:!0}))}else for(let y of g.variants)H.push(C(R({},M),{url:y.url,quality:y.quality,audioInfo:b,isMaster:!1}))}}catch(g){console.error(`[Tamilblasters] Failed to extract stream: ${g.message}`)}let D=H;if(e!==null||i!==null){let M=i!==null?`EP${i.toString().padStart(2,"0")}`:null,g=i!==null?`e${i.toString().padStart(2,"0")}`:null,b=i!==null?`e ${i.toString().padStart(2,"0")}`:null,y=e!==null?`S${e.toString().padStart(2,"0")}`:null,U=e!==null?`s${e.toString().padStart(2,"0")}`:null;if(!y||u.title.toUpperCase().includes(y)||u.title.toLowerCase().includes(U)){let O=D.filter(W=>{if(!M)return!0;let z=W.title.toUpperCase(),L=W.title.toLowerCase();return z.includes(M)||L.includes(g)||L.includes(b)||z.includes(`EPISODE ${i}`)});D=O,O.length>0?console.log(`[Tamilblasters] Filtered to ${D.length} streams for episode ${i}`):console.log(`[Tamilblasters] No streams found matching epsiode ${i}`)}else D=[]}if(console.log(`[Tamilblasters] Successfully extracted ${D.length} direct streams for "${u.title}"`),f.push(...D),f.length>=10){console.log(`[Tamilblasters] Found ${f.length} streams, stopping early`);break}}catch(p){console.error(`[Tamilblasters] Failed to process match ${u.title}:`,p.message)}}return f.map(u=>{let p=u.quality||"Unknown",d="UNKNOWN";if(u.matchTitle&&p!=="Unknown"){let P=new RegExp(`${p}\\s*[\\[\\(]([^\\]\\)]+)[\\]\\)]`,"i"),E=u.matchTitle.match(P);E&&(d=E[1].toUpperCase())}let w=C(R({},u),{quality:p,size:d});return{name:"Tamilblasters",title:ht(a,w),url:u.url,quality:w.quality,headers:{Referer:S,"User-Agent":N["User-Agent"]},provider:"Tamilblasters"}})}catch(a){return console.error("[Tamilblasters] getStreams failed:",a.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:J}:global.getStreams={getStreams:J};
