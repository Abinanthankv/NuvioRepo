/**
 * tamilblasters - Built from src/tamilblasters/
 * Generated: 2026-01-14T07:39:23.174Z
 */
var me=Object.defineProperty,ge=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var oe=(e,s,t)=>s in e?me(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,C=(e,s)=>{for(var t in s||(s={}))we.call(s,t)&&oe(e,t,s[t]);if(ie)for(var t of ie(s))ye.call(s,t)&&oe(e,t,s[t]);return e},k=(e,s)=>ge(e,pe(s));var M=(e,s,t)=>new Promise((n,r)=>{var o=l=>{try{d(t.next(l))}catch(a){r(a)}},u=l=>{try{d(t.throw(l))}catch(a){r(a)}},d=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,u);d((t=t.apply(e,s)).next())});var ue=require("cheerio-without-node-native"),$e="1b3113663c9004682ed61086cf967c44",Te="https://api.themoviedb.org/3",b="https://www.1tamilblasters.business",R={"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36",Referer:`${b}/`};function z(n){return M(this,arguments,function*(e,s={},t=1e4){let r=new AbortController,o=setTimeout(()=>r.abort(),t);try{let u=yield fetch(e,k(C({},s),{signal:r.signal}));return clearTimeout(o),u}catch(u){throw clearTimeout(o),u.name==="AbortError"?new Error(`Request timeout after ${t}ms`):u}})}function ee(t){return M(this,arguments,function*(e,s={}){try{let n=yield z(e,{method:"GET",headers:k(C({},s),{Range:"bytes=0-0"})},5e3);return n.ok||n.status===206}catch(n){return!1}})}function be(e){return e?e.replace(/\w\S*/g,s=>s.charAt(0).toUpperCase()+s.substr(1).toLowerCase()):""}function le(e){return e?e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim():""}function Se(e,s){let t=le(e),n=le(s);if(t===n)return 1;if(t.includes(n)||n.includes(t))return .9;let r=new Set(t.split(/\s+/).filter(l=>l.length>2)),o=new Set(n.split(/\s+/).filter(l=>l.length>2));if(r.size===0||o.size===0)return 0;let u=new Set([...r].filter(l=>o.has(l))),d=new Set([...r,...o]);return u.size/d.size}function Ee(e,s,t,n){for(;t--;)if(n[t]){let r=t.toString(s);e=e.replace(new RegExp("\\b"+r+"\\b","g"),n[t])}return e}function Me(e,s){if(!s||s.length===0)return[];let t=e.title.toLowerCase().replace(/[^a-z0-9]/g,""),n=e.year?parseInt(e.year):null,r=[];for(let o of s){let u=o.title.toLowerCase().replace(/[^a-z0-9]/g,""),d=Se(e.title,o.title),l=u.includes(t),a=!n||o.title.includes(n.toString())||o.title.includes((n+1).toString())||o.title.includes((n-1).toString());l&&a&&(d+=.5),d>.4&&(console.log(`[Tamilblasters] Match found: "${o.title}" (score: ${d.toFixed(2)})`),r.push(o))}return r}function Ue(e,s){let{title:t,year:n}=e,{quality:r,type:o,size:u,language:d,seasonCode:l,episodeCode:a,label:c,baseTitle:i}=s,h=t.toLowerCase()===i.toLowerCase()||t===t.toLowerCase()?i:t,S=n||s.year,g=S?` (${S})`:"",p=!!(l||a),N=`\u{1F4FC}: ${h}${g}`;p?N+=` - ${l||"S01"} ${a||""}`:c&&!c.includes("Stream")&&(N+=` (${c})`),N+=` - ${r!=="Unknown"?r:""}`;let K=o&&o!=="UNKNOWN"?`\u{1F4FA}: ${o}
`:"",D=u&&u!=="UNKNOWN"?`\u{1F4BE}: ${u} | \u{1F69C}: tamilblasters
`:"",j=d||"TAMIL";return s.audioInfo&&(j=s.audioInfo),`Tamilblasters (Instant) (${r})
${K}${N}
${D}\u{1F310}: ${j.toUpperCase()}`}function Le(e,s){return M(this,null,function*(){let n=`${Te}/${s==="movie"?"movie":"tv"}/${e}?api_key=${$e}`;try{let o=yield(yield z(n,{},8e3)).json(),u={title:o.title||o.name,year:(o.release_date||o.first_air_date||"").split("-")[0]};return console.log(`[Tamilblasters] TMDB Info: "${u.title}" (${u.year||"N/A"})`),u}catch(r){throw console.error("[Tamilblasters] Error fetching TMDB metadata:",r.message),r}})}function ve(e){return M(this,null,function*(){let s=`${b}/?s=${encodeURIComponent(e)}`;console.log(`[Tamilblasters] Searching: ${s}`);try{let t=yield z(s,{headers:R},8e3);if(t.url&&!t.url.includes(new URL(b).hostname))try{let u=new URL(t.url);u.protocol.startsWith("http")&&(console.log(`[Tamilblasters] Domain redirect detected: ${b} -> ${u.origin}`),b=u.origin,R.Referer=`${b}/`)}catch(u){}let n=yield t.text(),r=ue.load(n),o=[];return r(".posts-wrapper article, .nv-index-posts article").each((u,d)=>{let l=r(d).find("h2.entry-title a"),a=l.text().trim(),c=l.attr("href");a&&c&&o.push({title:a,href:c})}),o}catch(t){return console.error("[Tamilblasters] Search error:",t.message),[]}})}function Re(e){return M(this,null,function*(){try{let t=yield(yield z(e,{headers:k(C({},R),{Referer:b})},5e3)).text();if(!t.includes("#EXTM3U"))return{variants:[{url:e,quality:"Unknown"}],audios:[],isMaster:!1,masterUrl:e};let n=[],r=[],o=!1,u=t.matchAll(/#EXT-X-MEDIA:TYPE=AUDIO.*?NAME="([^"]+)"(?:.*?CHANNELS="([^"]+)")?/g);for(let a of u){let c=a[1],i=a[2];i&&(c+=` (${{1:"1.0",2:"2.0",6:"5.1",8:"7.1"}[i]||i})`),r.includes(c)||r.push(c)}if(t.includes("#EXT-X-STREAM-INF")){o=!0;let a=t.split(`
`);for(let c=0;c<a.length;c++){let i=a[c].trim();if(i.includes("#EXT-X-STREAM-INF")){let h="Unknown",S=i.match(/RESOLUTION=(\d+)x(\d+)/i);if(S){let p=parseInt(S[2]);p>=2160?h="4K":p>=1080?h="1080p":p>=720?h="720p":p>=480?h="480p":h=`${p}p`}let g=c+1;for(;g<a.length&&(a[g].trim().startsWith("#")||!a[g].trim());)g++;if(g<a.length){let p=a[g].trim();p&&!p.startsWith("#")&&(p.startsWith("http")||(p=e.substring(0,e.lastIndexOf("/")+1)+p),n.push({url:p,quality:h}))}c=g}}}if(n.length>0){let a={"4K":2160,"1080p":1080,"720p":720,"480p":480,Unknown:0};return n.sort((c,i)=>(a[i.quality]||0)-(a[c.quality]||0)),{variants:n,audios:r,isMaster:o,masterUrl:e}}let d=t.match(/\b(2160p|1080p|720p|480p|4K|UHD|HD)\b/i),l=d?d[0]:"Unknown";return{variants:[{url:e,quality:l}],audios:r,isMaster:!1,masterUrl:e}}catch(s){return console.error(`[Tamilblasters] Error detecting quality: ${s.message}`),{variants:[{url:e,quality:"Unknown"}],audios:[],isMaster:!1,masterUrl:e}}})}function Ce(e){return M(this,null,function*(){try{console.log(`[Tamilblasters] Embed URL: ${e}`);let t=new URL(e).hostname.toLowerCase();return console.log(`[Tamilblasters] Attempting universal extraction from: ${t}`),yield ke(e,t)}catch(s){return console.error(`[Tamilblasters] Extraction error: ${s.message}`),[]}})}function ke(e,s){return M(this,null,function*(){try{let t=new URL(e).origin,r=yield(yield z(e,{headers:k(C({},R),{Referer:b})},5e3)).text();if(r.includes("<title>Loading...</title>")||r.includes("Page is loading")){console.log(`[Tamilblasters] Detected landing page on ${s}, trying mirrors...`);let l=["yuguaab.com","cavanhabg.com"];for(let a of l){if(s.includes(a))continue;let c=e.replace(s,a);try{let h=yield(yield z(c,{headers:k(C({},R),{Referer:b})},3e3)).text();if(h.includes("jwplayer")||h.includes("sources")||h.includes("eval(function(p,a,c,k,e,d)")){r=h;break}}catch(i){}}}let o=r.match(new RegExp("eval\\(function\\(p,a,c,k,e,d\\)\\{.*?\\}\\s*\\((.*)\\)\\s*\\)","s"));if(o){let a=o[1].trim().match(new RegExp("^'(.*)',\\s*(\\d+),\\s*(\\d+),\\s*'(.*?)'\\.split\\(","s"));if(a){let c=Ee(a[1],parseInt(a[2]),parseInt(a[3]),a[4].split("|"));r+=`
`+c}}let u=[/["']hls[2-4]["']\s*:\s*["']([^"']+)["']/gi,/sources\s*:\s*\[\s*{\s*file\s*:\s*["']([^"']+)["']/gi,/https?:\/\/[^\s"']+\.m3u8[^\s"']*/gi,/["'](\/[^\s"']+\.m3u8[^\s"']*)["']/gi],d=[];for(let l of u){let a=r.match(l);if(a)for(let c of a){let i=c,h=c.match(/["']:[ ]*["']([^"']+)["']/);if(h)i=h[1];else{let g=c.match(/["']([^"']+)["']/);g&&(i=g[1])}let S=i.match(/https?:\/\/[^\s"']+/);S&&(i=S[0]),i=i.replace(/[\\"'\)\]]+$/,""),!(!i||i.length<5||i.includes("google.com")||i.includes("youtube.com"))&&(i.startsWith("/")&&!i.startsWith("//")&&(i=t+i),d.push(i))}}if(d.length>0){d.sort((a,c)=>{let i=a.includes("?"),h=c.includes("?");if(i!==h)return h?1:-1;let S=a.toLowerCase().includes(".m3u8"),g=c.toLowerCase().includes(".m3u8");return S!==g?g?1:-1:a.length-c.length});let l=d[0];return console.log(`[Tamilblasters] Detected best URL: ${l}. Resolving quality...`),yield Re(l)}return[]}catch(t){return console.error(`[Tamilblasters] Error extracting from ${s}: ${t.message}`),[]}})}function ce(e,s="movie",t=null,n=null){return M(this,null,function*(){console.log(`[Tamilblasters] Processing ${s} ${e}`);try{let r;if(/^\d+$/.test(e))try{r=yield Le(e,s)}catch(f){console.log(`[Tamilblasters] TMDB fetch failed, using "${e}" as search query`),r={title:e,year:null}}else console.log(`[Tamilblasters] Using "${e}" as search query indirectly`),r={title:be(e),year:null};let u=yield ve(r.title),d=Me(r,u);if(d.length===0)return console.warn("[Tamilblasters] No matching titles found in search results"),[];let l=[],a=new Set;for(let f of d)a.has(f.href)||(a.add(f.href),l.push(f));let c=l.slice(0,3);console.log(`[Tamilblasters] Processing top ${c.length} unique matches out of ${d.length} total`);let i=[],h=5,S=2,g=new Set,p=!1,N=f=>M(this,null,function*(){var U;if(!(i.length>=h||p)){console.log(`[Tamilblasters] Processing match: ${f.title} -> ${f.href}`);try{let V=yield(yield z(f.href,{headers:R},8e3)).text(),A=ue.load(V),Y=A("h1.entry-title").text().trim()||f.title;console.log(`[Tamilblasters] Full Page Title: ${Y}`);let W=[],q=f.title,G=q.match(/[\(\[](\d{4})[\)\]]/),te=q,se="",re="Original";G&&(se=G[1],te=q.split(G[0])[0].trim(),re=((U=q.split(G[0])[1])==null?void 0:U.trim())||"Original"),A("iframe").each((L,m)=>{let v=A(m).attr("src");if(!v||v.includes("google.com")||v.includes("youtube.com"))return;let E="",w=A(m);for(let P=0;P<5;P++){let x=w.prev();if(x.length===0){if(w=w.parent(),w.is("body")||w.length===0)break;continue}let X=x.text().trim();if(X.toLowerCase().includes("episode")){E=X.replace(/[\r\n]+/g," ").trim();break}w=x}let y=E||A(m).closest("div").prev("p").text().trim()||"Stream "+(L+1);if(y.toLowerCase().includes("episode")){let P=y.match(/Episode\s*[–-ー]\s*(\d+)/i)||y.match(/Episode\s*(\d+)/i);P&&(y=`EP${P[1]}`)}let J=s==="tv"||q.match(/S\d+.*EP/i)||q.match(/Season.*Episode/i)||y.match(/EP\s*\d+/i)||y.match(/Episode\s*\d+/i),I="",O="",H=re;if(J){let P=q.match(/S(\d+)/i);I=P?`S${P[1].padStart(2,"0")}`:"S01";let x=null,X=y.match(/EP\s*(\d+)/i)||y.match(/Episode\s*(\d+)/i);if(X)x=X[1];else{let ne=q.match(/EP\s*(\d+)/i);ne&&(x=ne[1])}O=x?`E${x.padStart(2,"0")}`:y,H=H.replace(/S\d+/gi,"").replace(/EP\s*\(.*?\)/gi,"").replace(/EP\d+/gi,"").replace(/\s+/g," ").trim(),H=H.replace(/^[-\s,[\]]+|[-\s,[\]]+$/g,"").trim()}let $="UNKNOWN",T=(Y+" "+y).toLowerCase();T.includes("bluray")||T.includes("brrip")?$="BluRay":T.includes("web-dl")||T.includes("webdl")?$="WEB-DL":T.includes("webrip")?$="WEBRip":T.includes("hdrip")?$="HDRip":T.includes("dvdrip")&&($="DVDRip"),W.push({baseTitle:te,year:se,language:H,seasonCode:I,episodeCode:O,type:$,url:v,label:y,matchTitle:f.title})});let ae=W.slice(0,5);W.length>5&&console.log(`[Tamilblasters] Limiting to first 5 iframes out of ${W.length} for performance`),console.log(`[Tamilblasters] Extracting direct streams from ${ae.length} embed URLs for "${f.title}"...`);let Z=[],Q=new Set,he=5,_=new Set,de=L=>M(this,null,function*(){if(!(i.length>=h||p))try{let m=yield Promise.race([Ce(L.url),new Promise((v,E)=>setTimeout(()=>E(new Error("Extraction timeout after 5 seconds")),5e3))]);if(m&&m.variants&&m.variants.length>0){let v=m.audios.length>0?m.audios.join(", "):"";if(m.isMaster&&m.audios.length>1){let E=m.variants[0].quality,w=k(C({},L),{url:m.masterUrl,quality:E,audioInfo:v,isMaster:!0});(yield ee(w.url,{Referer:b,"User-Agent":R["User-Agent"]}))&&!Q.has(w.url)&&(Q.add(w.url),Z.push(w))}else for(let E of m.variants){let w=k(C({},L),{url:E.url,quality:E.quality,audioInfo:v,isMaster:!1});(yield ee(w.url,{Referer:b,"User-Agent":R["User-Agent"]}))&&!Q.has(w.url)&&(Q.add(w.url),Z.push(w))}}}catch(m){console.error(`[Tamilblasters] Failed to extract stream: ${m.message}`)}});for(let L of ae){if(i.length>=h||p)break;let m=de(L).then(()=>_.delete(m));_.add(m),_.size>=he&&(yield Promise.race(_))}yield Promise.all(_);let B=Z;if(t!==null||n!==null){let L=n!==null?`EP${n.toString().padStart(2,"0")}`:null,m=n!==null?`e${n.toString().padStart(2,"0")}`:null,v=n!==null?`e ${n.toString().padStart(2,"0")}`:null,E=t!==null?`S${t.toString().padStart(2,"0")}`:null,w=t!==null?`s${t.toString().padStart(2,"0")}`:null;if(!E||f.title.toUpperCase().includes(E)||f.title.toLowerCase().includes(w)){let J=B.filter(I=>{if(!L)return!0;let O=`${I.label} ${I.episodeCode}`.toUpperCase();if(O.includes("EP")||O.includes("E")||/\d+/.test(I.episodeCode)){let $=O,T=$.toLowerCase();return $.includes(L)||T.includes(m)||T.includes(v)||$.includes(`EPISODE ${n}`)}else{let $=`${I.matchTitle}`.toUpperCase(),T=$.toLowerCase();return $.includes(L)||T.includes(m)||T.includes(v)||$.includes(`EPISODE ${n}`)}});B=J,J.length>0?console.log(`[Tamilblasters] Filtered to ${B.length} streams for episode ${n}`):console.log(`[Tamilblasters] No streams found matching epsiode ${n}`)}else B=[]}B.length>0&&i.push(...B),i.length>=h&&(p=!0)}catch(F){console.error(`[Tamilblasters] Failed to process match ${f.title}:`,F.message)}}});for(let f of c){if(i.length>=h||p)break;let U=N(f).then(()=>g.delete(U));g.add(U),g.size>=S&&(yield Promise.race(g))}yield Promise.all(g),console.log(`[Tamilblasters] Final validation of ${i.length} candidate streams...`);let K=[],D=new Set,j=5,fe=f=>M(this,null,function*(){try{if(yield ee(f.url,{Referer:b,"User-Agent":R["User-Agent"]})){let F=f.quality||"Unknown",V="UNKNOWN";if(f.matchTitle&&F!=="Unknown"){let Y=new RegExp(`${F}\\s*[\\[\\(]([^\\]\\)]+)[\\]\\)]`,"i"),W=f.matchTitle.match(Y);W&&(V=W[1].toUpperCase())}let A=k(C({},f),{quality:F,size:V});K.push({name:"Tamilblasters",title:Ue(r,A),url:f.url,quality:A.quality,headers:{Referer:b,"User-Agent":R["User-Agent"]},provider:"Tamilblasters"})}}catch(U){console.error(`[Tamilblasters] Validation failed for ${f.url}:`,U.message)}});for(let f of i){let U=fe(f).then(()=>D.delete(U));D.add(U),D.size>=j&&(yield Promise.race(D))}return yield Promise.all(D),console.log(`[Tamilblasters] Returning ${K.length} valid streams out of ${i.length} candidates`),K}catch(r){return console.error("[Tamilblasters] getStreams failed:",r.message),[]}})}typeof module!="undefined"&&module.exports?module.exports={getStreams:ce}:global.getStreams={getStreams:ce};
